[{"FileName": "zend_execute_API_before.c", "Caller": "zend_handle_sigsegv", "Source": false, "Sink": false, "idx": 0, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "signal", "line": 60, "label": -3, "slices": ["\tif (original_sigsegv_handler == zend_handle_sigsegv) {\n", "\t\tsignal(SIGSEGV, original_sigsegv_handler);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_handle_sigsegv", "Source": false, "Sink": false, "idx": 1, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "signal", "line": 62, "label": -3, "slices": ["\tif (original_sigsegv_handler == zend_handle_sigsegv) {\n", "else\n", "\t\tsignal(SIGSEGV, SIG_DFL);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_handle_sigsegv", "Source": false, "Sink": false, "idx": 2, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "fprintf", "line": 66, "label": -3, "slices": ["\t\tfprintf(stderr, \"SIGSEGV caught on opcode %d on opline %d of %s() at %s:%d\\n\\n\",\n\t\t\t\tactive_opline->opcode,\n\t\t\t\tactive_opline-EG(active_op_array)->opcodes,\n\t\t\t\tget_active_function_name(),\n\t\t\t\tzend_get_executed_filename(),\n\t\t\t\tzend_get_executed_lineno());\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "init_executor", "Source": false, "Sink": false, "idx": 3, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "signal", "line": 136, "label": -3, "slices": ["\toriginal_sigsegv_handler = signal(SIGSEGV, zend_handle_sigsegv);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "init_executor", "Source": false, "Sink": false, "idx": 4, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 184, "label": -3, "slices": ["\tEG(ht_iterators_used) = 0;\n", "\tEG(ht_iterators) = EG(ht_iterators_slots);\n", "\tmemset(EG(ht_iterators), 0, sizeof(EG(ht_iterators_slots)));\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "shutdown_executor", "Source": false, "Sink": false, "idx": 5, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "signal", "line": 383, "label": -3, "slices": ["\tsignal(SIGSEGV, original_sigsegv_handler);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zval_update_constant_ex", "Source": false, "Sink": false, "idx": 6, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memmove", "line": 594, "label": -3, "slices": ["ZEND_API int zval_update_constant_ex(zval *p, zend_bool inline_change, zend_class_entry *scope) /* {{{ */\n", "\tzval *const_value;\n", "\tchar *colon;\n", "\tif (IS_CONSTANT_VISITED(p)) {\n", "\t\tzend_throw_error(NULL, \"Cannot declare self-referencing constant '%s'\", Z_STRVAL_P(p));\n", "else\n", "\t} else if (Z_TYPE_P(p) == IS_CONSTANT) {\n", "\t\tSEPARATE_ZVAL_NOREF(p);\n", "\t\tMARK_CONSTANT_VISITED(p);\n", "\t\tif (Z_CONST_FLAGS_P(p) & IS_CONSTANT_CLASS) {\n", "\t\t\tif (inline_change) {\n", "\t\t\t\tzend_string_release(Z_STR_P(p));\n", "\t\t\tif (EG(scope) && EG(scope)->name) {\n", "\t\t\t\tZVAL_STR_COPY(p, EG(scope)->name);\n", "else\n", "\t\t\t\tZVAL_EMPTY_STRING(p);\n", "else\n", "\t\t} else if (UNEXPECTED((const_value = zend_get_constant_ex(Z_STR_P(p), scope, Z_CONST_FLAGS_P(p))) == NULL)) {\n", "\t\t\tchar *actual = Z_STRVAL_P(p);\n", "\t\t\tif (UNEXPECTED(EG(exception))) {\n", "\t\t\t\tRESET_CONSTANT_VISITED(p);\n", "else\n", "\t\t\t} else if ((colon = (char*)zend_memrchr(Z_STRVAL_P(p), ':', Z_STRLEN_P(p)))) {\n", "\t\t\t\tzend_throw_error(NULL, \"Undefined class constant '%s'\", Z_STRVAL_P(p));\n", "\t\t\t\tRESET_CONSTANT_VISITED(p);\n", "else\n", "\t\t\t\tzend_string *save = Z_STR_P(p);\n", "\t\t\t\tchar *slash;\n", "\t\t\t\tsize_t actual_len = Z_STRLEN_P(p);\n", "\t\t\t\tif ((Z_CONST_FLAGS_P(p) & IS_CONSTANT_UNQUALIFIED) && (slash = (char *)zend_memrchr(actual, '\\\\', actual_len))) {\n", "\t\t\t\t\tactual_len -= (actual - Z_STRVAL_P(p));\n", "\t\t\t\t\tif (inline_change) {\n", "\t\t\t\t\t\tzend_string *s = zend_string_init(actual, actual_len, 0);\n", "\t\t\t\t\t\tZ_STR_P(p) = s;\n", "\t\t\t\t\t\tZ_TYPE_FLAGS_P(p) = IS_TYPE_REFCOUNTED | IS_TYPE_COPYABLE;\n", "\t\t\t\tif (actual[0] == '\\\\') {\n", "\t\t\t\t\tif (inline_change) {\n", "\t\t\t\t\t\tmemmove(Z_STRVAL_P(p), Z_STRVAL_P(p)+1, Z_STRLEN_P(p));\n", "\t\t\t\t\t\t--Z_STRLEN_P(p);\n", "\t\t\t\tif ((Z_CONST_FLAGS_P(p) & IS_CONSTANT_UNQUALIFIED) == 0) {\n", "\t\t\t\t\tRESET_CONSTANT_VISITED(p);\n", "\t\t\t\t\tif (!inline_change) {\n", "\t\t\t\t\t\tZVAL_STRINGL(p, actual, actual_len);\n", "else\n", "\t\t\t\t\t\tZ_TYPE_INFO_P(p) = Z_REFCOUNTED_P(p) ?\n", "else\n", "\t\t\tif (inline_change) {\n", "\t\t\t\tzend_string_release(Z_STR_P(p));\n", "\t\t\tZVAL_COPY_VALUE(p, const_value);\n", "\t\t\tif (Z_OPT_CONSTANT_P(p)) {\n", "\t\t\t\tif (UNEXPECTED(zval_update_constant_ex(p, 1, NULL) != SUCCESS)) {\n", "\t\t\t\t\tRESET_CONSTANT_VISITED(p);\n", "\t\t\tzval_opt_copy_ctor(p);\n", "else\n", "\t} else if (Z_TYPE_P(p) == IS_CONSTANT_AST) {\n", "\t\tif (UNEXPECTED(zend_ast_evaluate(&tmp, Z_ASTVAL_P(p), scope) != SUCCESS)) {\n", "\t\tif (inline_change) {\n", "\t\t\tzval_ptr_dtor(p);\n", "\t\tZVAL_COPY_VALUE(p, &tmp);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_call_function", "Source": false, "Sink": false, "idx": 7, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 718, "label": -3, "slices": ["\tif (!EG(active)) {\n", "\tif (EG(exception)) {\n", "\tif (!EG(current_execute_data)) {\n", "\t\tmemset(&dummy_execute_data, 0, sizeof(zend_execute_data));\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_lookup_class_ex", "Source": false, "Sink": false, "idx": 8, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "strspn", "line": 992, "label": -3, "slices": ["ZEND_API zend_class_entry *zend_lookup_class_ex(zend_string *name, const zval *key, int use_autoload) /* {{{ */\n", "\tzend_class_entry *ce = NULL;\n", "\tzval args[1];\n", "\tzend_string *lc_name;\n", "\tif (key) {\n", "else\n", "\t\tif (name == NULL || !ZSTR_LEN(name)) {\n", "\t\tif (ZSTR_VAL(name)[0] == '\\\\') {\n", "\t\t\tlc_name = zend_string_alloc(ZSTR_LEN(name) - 1, 0);\n", "\t\t\tzend_str_tolower_copy(ZSTR_VAL(lc_name), ZSTR_VAL(name) + 1, ZSTR_LEN(name) - 1);\n", "else\n", "\t\t\tlc_name = zend_string_tolower(name);\n", "\tif (ce) {\n", "\tif (!use_autoload || zend_is_compiling()) {\n", "\tif (!EG(autoload_func)) {\n", "\t\tzend_function *func = zend_hash_str_find_ptr(EG(function_table), ZEND_AUTOLOAD_FUNC_NAME, sizeof(ZEND_AUTOLOAD_FUNC_NAME) - 1);\n", "\t\tif (func) {\n", "\tif (strspn(ZSTR_VAL(name), \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\") != ZSTR_LEN(name)) {\n", "\tif (zend_hash_add_empty_element(EG(in_autoload), lc_name) == NULL) {\n", "\tif (ZSTR_VAL(name)[0] == '\\\\') {\n", "\t\tZVAL_STRINGL(&args[0], ZSTR_VAL(name) + 1, ZSTR_LEN(name) - 1);\n", "else\n", "\t\tZVAL_STR_COPY(&args[0], name);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_eval_stringl", "Source": false, "Sink": false, "idx": 9, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memcpy", "line": 1103, "label": -3, "slices": ["\tzval pv;\n", "\tif (retval_ptr) {\n", "\t\tmemcpy(Z_STRVAL(pv), \"return \", sizeof(\"return \") - 1);\n", "\t\tmemcpy(Z_STRVAL(pv) + sizeof(\"return \") - 1, str, str_len);\n", "\t\tZ_STRVAL(pv)[Z_STRLEN(pv) - 1] = ';';\n", "\t\tZ_STRVAL(pv)[Z_STRLEN(pv)] = '\\0';\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_eval_stringl", "Source": false, "Sink": false, "idx": 10, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memcpy", "line": 1104, "label": -3, "slices": ["ZEND_API int zend_eval_stringl(char *str, size_t str_len, zval *retval_ptr, char *string_name) /* {{{ */\n", "\tzval pv;\n", "\tif (retval_ptr) {\n", "\t\tZVAL_NEW_STR(&pv, zend_string_alloc(str_len + sizeof(\"return ;\")-1, 1));\n", "\t\tmemcpy(Z_STRVAL(pv), \"return \", sizeof(\"return \") - 1);\n", "\t\tmemcpy(Z_STRVAL(pv) + sizeof(\"return \") - 1, str, str_len);\n", "\t\tZ_STRVAL(pv)[Z_STRLEN(pv) - 1] = ';';\n", "\t\tZ_STRVAL(pv)[Z_STRLEN(pv)] = '\\0';\n", "else\n", "\t\tZVAL_STRINGL(&pv, str, str_len);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_eval_string", "Source": false, "Sink": false, "idx": 11, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "strlen", "line": 1158, "label": -3, "slices": ["ZEND_API int zend_eval_string(char *str, zval *retval_ptr, char *string_name) /* {{{ */\n", "\treturn zend_eval_stringl(str, strlen(str), retval_ptr, string_name);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_eval_string_ex", "Source": false, "Sink": false, "idx": 12, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "strlen", "line": 1177, "label": -3, "slices": ["ZEND_API int zend_eval_string_ex(char *str, zval *retval_ptr, char *string_name, int handle_exceptions) /* {{{ */\n", "\treturn zend_eval_stringl_ex(str, strlen(str), retval_ptr, string_name, handle_exceptions);\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_verify_abstract_class", "Source": false, "Sink": false, "idx": 13, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memset", "line": 1439, "label": -3, "slices": ["\tif ((ce->ce_flags & ZEND_ACC_IMPLICIT_ABSTRACT_CLASS) && !(ce->ce_flags & (ZEND_ACC_TRAIT | ZEND_ACC_EXPLICIT_ABSTRACT_CLASS))) {\n", "\t\tmemset(&ai, 0, sizeof(ai));\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_set_local_var", "Source": false, "Sink": false, "idx": 14, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memcmp", "line": 1590, "label": -3, "slices": ["ZEND_API int zend_set_local_var(zend_string *name, zval *value, int force) /* {{{ */\n", "\tzend_execute_data *execute_data = EG(current_execute_data);\n", "\twhile (execute_data && (!execute_data->func || !ZEND_USER_CODE(execute_data->func->common.type))) {\n", "\t\texecute_data = execute_data->prev_execute_data;\n", "\tif (execute_data) {\n", "\t\tif (!execute_data->symbol_table) {\n", "\t\t\tzend_ulong h = zend_string_hash_val(name);\n", "\t\t\tzend_op_array *op_array = &execute_data->func->op_array;\n", "\t\t\tif (EXPECTED(op_array->last_var)) {\n", "\t\t\t\tzend_string **str = op_array->vars;\n", "\t\t\t\tzend_string **end = str + op_array->last_var;\n", "\t\t\t\t\tif (ZSTR_H(*str) == h &&\n\t\t\t\t\t    ZSTR_LEN(*str) == ZSTR_LEN(name) &&\n\t\t\t\t\t    memcmp(ZSTR_VAL(*str), ZSTR_VAL(name), ZSTR_LEN(name)) == 0) {\n", "\t\t\t\t\t\tzval *var = EX_VAR_NUM(str - op_array->vars);\n", "\t\t\t\t\tstr++;\n", "\t\t\t\t} while (str != end);\n", "\t\t\tif (force) {\n", "\t\t\t\tzend_array *symbol_table = zend_rebuild_symbol_table();\n", "\t\t\t\tif (symbol_table) {\n", "\t\t\t\t\treturn zend_hash_update(symbol_table, name, value) ? SUCCESS : FAILURE;;\n", "else\n", "\t\t\treturn (zend_hash_update_ind(execute_data->symbol_table, name, value) != NULL) ? SUCCESS : FAILURE;\n"]}, {"FileName": "zend_execute_API_before.c", "Caller": "zend_set_local_var_str", "Source": false, "Sink": false, "idx": 15, "CWE-ID": "CWE-", "category": "CallExpression", "criterion": "memcmp", "line": 1631, "label": -3, "slices": ["ZEND_API int zend_set_local_var_str(const char *name, size_t len, zval *value, int force) /* {{{ */\n", "\tzend_execute_data *execute_data = EG(current_execute_data);\n", "\twhile (execute_data && (!execute_data->func || !ZEND_USER_CODE(execute_data->func->common.type))) {\n", "\t\texecute_data = execute_data->prev_execute_data;\n", "\tif (execute_data) {\n", "\t\tif (!execute_data->symbol_table) {\n", "\t\t\tzend_ulong h = zend_hash_func(name, len);\n", "\t\t\tzend_op_array *op_array = &execute_data->func->op_array;\n", "\t\t\tif (EXPECTED(op_array->last_var)) {\n", "\t\t\t\tzend_string **str = op_array->vars;\n", "\t\t\t\tzend_string **end = str + op_array->last_var;\n", "\t\t\t\t\tif (ZSTR_H(*str) == h &&\n\t\t\t\t\t    ZSTR_LEN(*str) == len &&\n\t\t\t\t\t    memcmp(ZSTR_VAL(*str), name, len) == 0) {\n", "\t\t\t\t\t\tzval *var = EX_VAR_NUM(str - op_array->vars);\n", "\t\t\t\t\tstr++;\n", "\t\t\t\t} while (str != end);\n", "\t\t\tif (force) {\n", "\t\t\t\tzend_array *symbol_table = zend_rebuild_symbol_table();\n", "\t\t\t\tif (symbol_table) {\n", "\t\t\t\t\treturn zend_hash_str_update(symbol_table, name, len, value) ? SUCCESS : FAILURE;;\n", "else\n", "\t\t\treturn (zend_hash_str_update_ind(execute_data->symbol_table, name, len, value) != NULL) ? SUCCESS : FAILURE;\n"]}]