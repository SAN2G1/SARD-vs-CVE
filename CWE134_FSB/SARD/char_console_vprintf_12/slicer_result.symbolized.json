[{"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12_bad", "Source": false, "Sink": true, "idx": 0, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 58, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        badVaSinkB(data, data);\n", "else\n", "        badVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC3(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12_bad", "Source": false, "Sink": true, "idx": 1, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "fgets", "line": 63, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        badVaSinkB(data, data);\n", "else\n", "        badVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC3(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12_bad", "Source": false, "Sink": true, "idx": 2, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 67, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        badVaSinkB(data, data);\n", "else\n", "        badVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC3(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12_bad", "Source": false, "Sink": true, "idx": 3, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strcpy", "line": 85, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        badVaSinkB(data, data);\n", "else\n", "        badVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC3(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 4, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 136, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 5, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "fgets", "line": 141, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 6, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 145, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 7, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 164, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 8, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "fgets", "line": 169, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodB2G", "Source": false, "Sink": true, "idx": 9, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strlen", "line": 173, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "else\n", "            size_t dataLen = strlen(data);\n", "            if (100-dataLen > 1)\n", "                if (fgets(data+dataLen, (int)(100-dataLen), stdin) != NULL)\n", "                    dataLen = strlen(data);\n", "                    if (dataLen > 0 && data[dataLen-1] == '\\n')\n", "                        data[dataLen-1] = '\\0';\n", "                    data[dataLen] = '\\0';\n", "    if(globalReturnsTrueOrFalse())\n", "        goodB2GVaSinkG(data, data);\n", "else\n", "        goodB2GVaSinkG(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nelse \nsize_t  Var3=strlen(Var1); \nif (100-Var3>1)\nif (fgets(Var1+Var3,(int )(100-Var3),stdin) != NULL )\nVar3=strlen(Var1); \nif (Var3>0&&Var1[Var3-1]==  Var4)\nVar1[Var3-1]=0; \nVar1[Var3]=0; \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodG2B", "Source": false, "Sink": true, "idx": 10, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strcpy", "line": 232, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "        strcpy(data, \"fixedstringtest\");\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        goodG2BVaSinkB(data, data);\n", "else\n", "        goodG2BVaSinkB(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nstrcpy(Var1,STRING); \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}, {"FileName": "CWE134_Uncontrolled_Format_String__char_console_vprintf_12.c", "Caller": "goodG2B", "Source": false, "Sink": true, "idx": 11, "CWE-ID": "CWE-134", "category": "CallExpression", "criterion": "strcpy", "line": 237, "label": 0, "slices": ["    char * data;\n", "    char dataBuffer[100] = \"\";\n", "    data = dataBuffer;\n", "    if(globalReturnsTrueOrFalse())\n", "        strcpy(data, \"fixedstringtest\");\n", "else\n", "        strcpy(data, \"fixedstringtest\");\n", "    if(globalReturnsTrueOrFalse())\n", "        goodG2BVaSinkB(data, data);\n", "else\n", "        goodG2BVaSinkB(data, data);\n"], "tokenized": "char *Var1; \nchar  Var2[100]=STRING; \nVar1=Var2; \nif (FUNC1())\nstrcpy(Var1,STRING); \nelse \nstrcpy(Var1,STRING); \nif (FUNC1())\nFUNC2(Var1,Var1); \nelse \nFUNC2(Var1,Var1); \n"}]