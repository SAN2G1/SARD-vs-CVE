[
  {
    "FileName": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34.c",
    "Caller": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_bad",
    "Source": false,
    "Sink": false,
    "idx": 0,
    "CWE-ID": "CWE-78",
    "category": "CallExpression",
    "criterion": "strlen",
    "line": 60,
    "label": 0,
    "slices": [
      "    char * data;\n",
      "    CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_unionType myUnion;\n",
      "    char dataBuffer[100] = COMMAND_ARG2;\n",
      "    data = dataBuffer;\n",
      "        size_t dataLen = strlen(data);\n",
      "        FILE * pFile;\n",
      "        if (100-dataLen > 1)\n",
      "            if (pFile != NULL)\n",
      "                if (fgets(data+dataLen, (int)(100-dataLen), pFile) == NULL)\n",
      "                    data[dataLen] = '\\0';\n",
      "    myUnion.unionFirst = data;\n",
      "        char * data = myUnion.unionSecond;\n",
      "            char *args[] = {COMMAND_INT_PATH, COMMAND_ARG1, COMMAND_ARG3, NULL};\n"
    ],
    "tokenized": "char *Var1; \nSTRUCT1  Var2; \nchar  Var3[100]=Var4; \nVar1=Var3; \nsize_t  Var5=strlen(Var1); \nSTRUCT2 *Var6; \nif (100-Var5>1)\nif (Var6 != NULL )\nif (fgets(Var1+Var5,(int )(100-Var5),Var6) == NULL )\nVar1[Var5]=0; \nVar2.memberVar1=Var1; \nchar *Var1=Var2.memberVar2; \nchar *Var7[]={Var8,Var9,Var10,NULL }; \n"
  },
  {
    "FileName": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34.c",
    "Caller": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_bad",
    "Source": false,
    "Sink": false,
    "idx": 1,
    "CWE-ID": "CWE-78",
    "category": "CallExpression",
    "criterion": "fopen",
    "line": 65,
    "label": 0,
    "slices": [
      "    char * data;\n",
      "        size_t dataLen = strlen(data);\n",
      "        FILE * pFile;\n",
      "        if (100-dataLen > 1)\n",
      "            pFile = fopen(FILENAME, \"r\");\n",
      "            if (pFile != NULL)\n",
      "                fclose(pFile);\n",
      "        char * data = myUnion.unionSecond;\n",
      "            char *args[] = {COMMAND_INT_PATH, COMMAND_ARG1, COMMAND_ARG3, NULL};\n"
    ],
    "tokenized": "char *Var1; \nsize_t  Var2=strlen(Var1); \nSTRUCT1 *Var3; \nif (100-Var2>1)\nVar3=fopen(Var4,STRING); \nif (Var3 != NULL )\nfclose(Var3); \nchar *Var1=Var5.memberVar1; \nchar *Var6[]={Var7,Var8,Var9,NULL }; \n"
  },
  {
    "FileName": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34.c",
    "Caller": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_bad",
    "Source": false,
    "Sink": false,
    "idx": 2,
    "CWE-ID": "CWE-78",
    "category": "CallExpression",
    "criterion": "fgets",
    "line": 69,
    "label": 0,
    "slices": [
      "    char * data;\n",
      "    CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_unionType myUnion;\n",
      "    char dataBuffer[100] = COMMAND_ARG2;\n",
      "    data = dataBuffer;\n",
      "        size_t dataLen = strlen(data);\n",
      "        FILE * pFile;\n",
      "        if (100-dataLen > 1)\n",
      "            pFile = fopen(FILENAME, \"r\");\n",
      "            if (pFile != NULL)\n",
      "                if (fgets(data+dataLen, (int)(100-dataLen), pFile) == NULL)\n",
      "                    data[dataLen] = '\\0';\n",
      "                fclose(pFile);\n",
      "    myUnion.unionFirst = data;\n",
      "        char * data = myUnion.unionSecond;\n",
      "            char *args[] = {COMMAND_INT_PATH, COMMAND_ARG1, COMMAND_ARG3, NULL};\n"
    ],
    "tokenized": "char *Var1; \nSTRUCT1  Var2; \nchar  Var3[100]=Var4; \nVar1=Var3; \nsize_t  Var5=strlen(Var1); \nSTRUCT2 *Var6; \nif (100-Var5>1)\nVar6=fopen(Var7,STRING); \nif (Var6 != NULL )\nif (fgets(Var1+Var5,(int )(100-Var5),Var6) == NULL )\nVar1[Var5]=0; \nfclose(Var6); \nVar2.memberVar1=Var1; \nchar *Var1=Var2.memberVar2; \nchar *Var8[]={Var9,Var10,Var11,NULL }; \n"
  },
  {
    "FileName": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34.c",
    "Caller": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_bad",
    "Source": false,
    "Sink": false,
    "idx": 3,
    "CWE-ID": "CWE-78",
    "category": "CallExpression",
    "criterion": "fclose",
    "line": 75,
    "label": 0,
    "slices": [
      "    char * data;\n",
      "        size_t dataLen = strlen(data);\n",
      "        FILE * pFile;\n",
      "        if (100-dataLen > 1)\n",
      "            pFile = fopen(FILENAME, \"r\");\n",
      "            if (pFile != NULL)\n",
      "                fclose(pFile);\n",
      "        char * data = myUnion.unionSecond;\n",
      "            char *args[] = {COMMAND_INT_PATH, COMMAND_ARG1, COMMAND_ARG3, NULL};\n"
    ],
    "tokenized": "char *Var1; \nsize_t  Var2=strlen(Var1); \nSTRUCT1 *Var3; \nif (100-Var2>1)\nVar3=fopen(Var4,STRING); \nif (Var3 != NULL )\nfclose(Var3); \nchar *Var1=Var5.memberVar1; \nchar *Var6[]={Var7,Var8,Var9,NULL }; \n"
  },
  {
    "FileName": "CWE78_OS_Command_Injection__char_file_w32_spawnvp_34.c",
    "Caller": "goodG2B",
    "Source": false,
    "Sink": false,
    "idx": 4,
    "CWE-ID": "CWE-78",
    "category": "CallExpression",
    "criterion": "strcat",
    "line": 104,
    "label": 1,
    "slices": [
      "    char * data;\n",
      "    CWE78_OS_Command_Injection__char_file_w32_spawnvp_34_unionType myUnion;\n",
      "    char dataBuffer[100] = COMMAND_ARG2;\n",
      "    data = dataBuffer;\n",
      "    strcat(data, \"*.*\");\n",
      "    myUnion.unionFirst = data;\n",
      "        char * data = myUnion.unionSecond;\n"
    ],
    "tokenized": "char *Var1; \nSTRUCT1  Var2; \nchar  Var3[100]=Var4; \nVar1=Var3; \nstrcat(Var1,STRING); \nVar2.memberVar1=Var1; \nchar *Var1=Var2.memberVar2; \n"
  }
]
